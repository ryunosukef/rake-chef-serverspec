box: wercker/ruby
build:
    steps:
        - bundle-install

        - script:
            name: echo ruby information
            code: |
                echo "ruby version $(ruby --version) running"
                echo "from location $(which ruby)"
                echo -p "gem list: $(gem list)"

        - script:
            name: setup vagrant
            code: |
                wget http://files.vagrantup.com/packages/a40522f5fabccb9ddabad03d836e120ff5d14093/vagrant_1.3.5_x86_64.deb
                sudo dpkg --install vagrant_1.3.5_x86_64.deb
                vagrant -v

        - script:
            name: setup vagrant plugin
            code: |
                vagrant plugin install vagrant-aws
                vagrant plugin install vagrant-ami
                vagrant plugin install vagrant-omnibus 

        - script:
            name: rake aws:up
            code: |
                rake aws:up vm=aws_dev --trace

